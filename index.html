<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>✨ 은사 발견 테스트</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');

        :root {
            --primary-color: #5a67d8;
            --primary-light: #ebf4ff;
            --background-color: #f7fafc;
            --card-background: #ffffff;
            --text-dark: #2d3748;
            --text-light: #718096;
            --border-color: #e2e8f0;
            --white: #fff;
            --success-color: #48bb78;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--background-color);
            color: var(--text-dark);
            /* 데스크톱에서는 상하좌우 여백 유지 */
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* 콘텐츠가 길어질 경우를 대비해 flex-start로 변경 */
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 700px;
        }

        .test-wrapper, #results {
            background-color: var(--card-background);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.07);
            padding: 40px;
            margin-bottom: 30px;
            width: 100%; /* 너비를 100%로 설정 */
        }

        h1 {
            color: var(--text-dark);
            text-align: center;
            margin-bottom: 15px;
            font-size: 2em;
            font-weight: 700;
        }

        .instructions {
            text-align: center;
            color: var(--text-light);
            background-color: var(--primary-light);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .instructions p { margin: 8px 0; }
        .instructions strong { color: var(--primary-color); }

        .progress-container { margin-bottom: 30px; }
        .progress-bar-bg { width: 100%; height: 12px; background-color: var(--border-color); border-radius: 6px; overflow: hidden; }
        .progress-bar-fg { width: 0%; height: 100%; background-color: var(--primary-color); border-radius: 6px; transition: width 0.4s ease-in-out; }
        .progress-text { text-align: right; font-size: 0.9em; color: var(--text-light); margin-top: 8px; font-weight: 500; }

        .question-card {
            margin-bottom: 15px;
            padding: 20px 25px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            transition: box-shadow 0.2s ease, border-color 0.2s ease;
        }

        .question-card:focus-within {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .question-text { font-weight: 500; line-height: 1.6; flex-grow: 1; }
        .score-selector { display: flex; gap: 10px; flex-shrink: 0; }

        .score-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: 2px solid var(--border-color);
            background-color: var(--card-background);
            color: var(--text-light);
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .score-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        .score-btn.selected {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: var(--white);
            transform: scale(1.1);
        }

        .submit-button {
            display: block;
            width: 100%;
            padding: 18px;
            font-size: 1.2em;
            font-weight: 700;
            color: var(--white);
            background: linear-gradient(45deg, #5a67d8, #7f9cf5);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            text-align: center;
            margin-top: 30px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(90, 103, 216, 0.4);
        }

        .submit-button:hover {
            opacity: 0.9;
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(90, 103, 216, 0.5);
        }

        #results {
            margin-top: 30px;
            display: none;
        }
        
        #results h2 { text-align: center; color: var(--text-dark); margin-bottom: 30px; }
        
        .result-item { display: flex; align-items: center; margin-bottom: 25px; }
        .result-item:last-child { margin-bottom: 0; }
        .rank { font-size: 1.8em; font-weight: 700; color: var(--text-light); width: 60px; text-align: center;}
        .result-details { flex-grow: 1; }
        .gift-name { font-size: 1.25em; font-weight: 700; margin: 0 0 10px 0; color: var(--text-dark); }
        .progress-bar-container { width: 100%; background-color: var(--border-color); border-radius: 8px; height: 22px; overflow: hidden; }
        .progress-bar { 
            height: 100%; 
            background: linear-gradient(90deg, var(--success-color), #81e6d9);
            width: 0%; 
            border-radius: 8px; 
            transition: width 1.5s cubic-bezier(0.25, 1, 0.5, 1);
            display: flex; 
            align-items: center; 
            justify-content: flex-end;
            color: var(--white); 
            font-size: 0.9em;
            font-weight: 700;
            padding-right: 10px;
        }

        /* --- 스마트폰 화면을 위한 수정 --- */
        @media (max-width: 700px) {
            body {
                /* 모바일에서는 body의 좌우 여백을 없애고 상하 여백만 줌 */
                padding: 20px 0;
            }
            .container {
                 /* 컨테이너에 좌우 여백을 주어 콘텐츠가 화면 끝에 붙지 않게 함 */
                padding: 0 15px;
            }
            .test-wrapper, #results {
                 /* 모바일에서 내부 여백을 살짝 줄여줌 */
                padding: 25px;
            }
            h1 { font-size: 1.7em; }
            .question-card { flex-direction: column; align-items: flex-start; gap: 15px; }
            .score-selector { align-self: center; width: 100%; justify-content: space-around; }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="test-wrapper">
            <h1>✨ 은사 발견 테스트 ✨</h1>
            <div class="instructions">
                <p>샬롬 :) <br> 여러분의 은사가 다시 불 붙기를 꿈 꾸며 <br> 은사테스트를 준비해 봤어요! <br> 이번 아웃리치가 열방 뿐 아니라 <br> 우리 서로를 세우는 사랑의 여정 되길 <br>마음 다해 축복합니다! - <strong>홍</strong></p>
                <p><br><br>각 문항이 자신에게 얼마나 해당하는지 <br><strong>숫자</strong>를 눌러 선택해주세요.</p>
                <p><strong>3</strong>: 매우 그렇다, <strong>2</strong>: 대체로 그렇다, <strong>1</strong>: 조금 그렇다, <strong>0</strong>: 전혀 그렇지 않다</p>
            </div>

            <form id="gifts-form">
                <div class="progress-container">
                    <div class="progress-bar-bg">
                        <div class="progress-bar-fg" id="progress-bar"></div>
                    </div>
                    <div class="progress-text" id="progress-text">0 / 90</div>
                </div>

                <div id="questions-container"></div>
                <button type="submit" class="submit-button">결과 확인하기</button>
            </form>
        </div>

        <div id="results">
            <h2>나의 은사 테스트 결과</h2>
            <div id="results-list"></div>
        </div>
    </div>

    <script>
        // 자바스크립트 코드는 이전과 동일합니다.
        const giftsData = [
            { id: 'pastoring', name: '양육', questions: [
                { id: 2, text: '사람들의 성공과 실패의 과정을 꾸준히 함께하며 그들의 성장을 돕는 것을 좋아합니다.' },
                { id: 27, text: '공동체 지체들의 영적인 성장을 돕는 것에 책임감을 느끼며, 그 역할을 기쁘게 감당합니다.' },
                { id: 52, text: '사람들을 영적으로 이끌고 지도하는 일에 큰 부담감이나 두려움이 없습니다.' },
                { id: 77, text: '동료 신앙인들을 말씀으로 격려하고, 그들을 위해 기도하며 함께 나아가는 편입니다.' },
                { id: 102, text: '주변 사람들은 저의 도움을 통해 공동체 생활을 더 잘하게 되었다고 이야기합니다.' }
            ]},
            { id: 'teaching', name: '가르침', questions: [
                { id: 3, text: '사람들은 제가 성경의 진리를 이해하기 쉽게 잘 설명해준다고 말합니다.' },
                { id: 28, text: '성경의 가르침을 공동체에 잘 적용하여 건강한 성장을 이룰 수 있도록 돕는 것에 자신 있습니다.' },
                { id: 53, text: '성경의 진리를 깊이 연구하고, 깨달은 것을 다른 사람들과 나누기 위해 시간을 기꺼이 사용합니다.' },
                { id: 78, text: '제가 가르칠 때, 사람들의 생각과 삶의 태도가 긍정적으로 변화되는 것을 자주 봅니다.' },
                { id: 103, text: '성경을 공부하고 그 내용을 다른 사람과 나누는 것은 저에게 큰 기쁨입니다.' }
            ]},
            { id: 'wisdom', name: '지혜', questions: [
                { id: 4, text: '하나님의 말씀을 제 삶의 문제에 적용하여 해결책을 찾는데 익숙합니다.' },
                { id: 29, text: '복잡하고 어려운 문제에 부딪혔을 때, 상황을 꿰뚫는 통찰력이나 해결책이 떠오를 때가 많습니다.' },
                { id: 54, text: '사람들이 고민을 털어놓을 때, 상황에 맞는 성경적인 조언을 해주곤 합니다.' },
                { id: 79, text: '성경의 진리를 잘 이해하고, 다른 사람의 필요에 맞게 지혜롭게 적용하여 도와준다는 말을 듣습니다.' },
                { id: 104, text: '중요한 결정을 내릴 때, 하나님께서 특별한 확신과 평안을 주시는 것을 경험하곤 합니다.' }
            ]},
            { id: 'knowledge', name: '지식', questions: [
                { id: 5, text: '성경적 지식이나 영적인 원리를 체계적으로 정리하고 알기 쉽게 설명하는 데 소질이 있습니다.' },
                { id: 30, text: '사람들이 하나님께 더 가까이 나아갈 수 있도록 돕는 영적인 통찰력을 자주 얻습니다.' },
                { id: 55, text: '연구와 경험을 통해 하나님 나라의 일을 더 효과적으로 할 수 있는 전략과 방법을 발견하곤 합니다.' },
                { id: 80, text: '성경의 새로운 진리를 깨닫기 위해 꾸준히 성경을 읽고 공부하는 시간을 갖습니다.' },
                { id: 105, text: '어떤 상황을 마주했을 때, 그 안에서 새로운 영적인 진리나 교훈을 발견하는 편입니다.' }
            ]},
            { id: 'exhortation', name: '권면', questions: [
                { id: 6, text: '낙심하고 힘들어하는 사람들을 진심 어린 말로 위로하고 격려하는 것을 좋아합니다.' },
                { id: 31, text: '사람들이 좋은 일에 참여하도록 동기를 부여하고 용기를 북돋아 주는 것에 능숙합니다.' },
                { id: 56, text: '슬픔이나 어려움에 처한 사람들이 저와 대화하고 나면 위로를 얻고 문제가 해결되는 데 도움을 받는다고 말합니다.' },
                { id: 81, text: '실망에 빠진 사람이나 죄책감으로 힘들어하는 사람들에게 효과적인 상담을 해주고 싶은 마음이 강합니다.' },
                { id: 106, text: '고난 중에 있는 사람들에게 성경 말씀으로 소망을 주며 이겨내도록 권면합니다.' }
            ]},
            { id: 'relationship', name: '관계', questions: [
                { id: 301, text: '새로운 사람들과 쉽게 친해지고, 사람들은 저와 함께 있을 때 편안함을 느낀다고 말합니다.' },
                { id: 302, text: '사람들은 저에게 고민을 자주 털어놓으며, 저와 대화하면 마음이 가벼워진다고 합니다.' },
                { id: 303, text: '공동체에 갈등이 생겼을 때, 중간에서 양쪽의 입장을 조율하고 화해시키는 역할을 자주 합니다.' },
                { id: 304, text: '사람을 판단하기보다 먼저 이해하려고 노력하며, 열린 마음으로 관계를 맺습니다.' },
                { id: 305, text: '사람들과 깊은 관계를 맺고 그 안에서 하나님의 사랑을 나누는 것이 저에게 큰 기쁨이 됩니다.' }
            ]},
            { id: 'helps', name: '도움', questions: [
                { id: 9, text: '리더나 다른 지체들이 맡은 사역을 잘 감당할 수 있도록 뒤에서 돕는 것을 즐거워합니다.' },
                { id: 34, text: '주변 사람들은 제가 그들의 사역에 실질적인 도움을 주었다고 자주 이야기합니다.' },
                { id: 59, text: '다른 사람들이 하기 싫어하거나 지루하게 느끼는 일이라도 기꺼이 맡아서 즐겁게 합니다.' },
                { id: 84, text: '드러나지 않게 다른 사람을 도울 때 조용한 기쁨과 보람을 느낍니다.' },
                { id: 109, text: '주님의 일을 할 때, 누가 더 많은 인정을 받는지에 크게 신경 쓰지 않습니다.' }
            ]},
            { id: 'mercy', name: '긍휼', questions: [
                { id: 10, text: '몸이나 마음에 아픔이 있는 사람들의 고통에 깊이 공감하며, 그들을 돕고 싶어 합니다.' },
                { id: 35, text: '어려움에 처한 사람들의 실제적인 필요를 채워주기 위해 적극적으로 나서는 편입니다.' },
                { id: 60, text: '병원이나 양로원 등 소외된 이웃을 찾아가 위로하고 함께 시간을 보내는 것에 보람을 느낍니다.' },
                { id: 85, text: '사람들은 어려운 이웃을 도와야 할 일이 생기면 저를 먼저 떠올리곤 합니다.' },
                { id: 110, text: '외로운 사람, 혼자 사는 사람, 감옥에 있는 사람들을 위해 기꺼이 제 시간을 사용합니다.' }
            ]},
            { id: 'missionary', name: '선교', questions: [
                { id: 11, text: '나와 다른 문화적 배경을 가진 사람들과 어울리는 것을 즐기며, 그들도 저를 편안하게 대합니다.' },
                { id: 36, text: '다른 문화권의 사람들에게 복음을 전하기 위해 외국어를 배우는 것에 흥미가 있고, 빨리 배우는 편입니다.' },
                { id: 61, text: '익숙한 환경을 떠나 새로운 문화 속에서 사는 것에 대한 두려움보다 기대감이 더 큽니다.' },
                { id: 86, text: '다양한 사람들에게 복음을 전할 수 있는 상황에 놓일 때 가장 큰 기쁨과 편안함을 느낍니다.' },
                { id: 111, text: '문화와 언어가 다른 사람들이 예수님을 믿고 변화되는 것을 보는 것이 제 삶의 가장 큰 소원입니다.' }
            ]},
            { id: 'evangelism', name: '전도', questions: [
                { id: 12, text: '믿지 않는 사람들에게 자연스럽게 다가가 예수님을 소개하고 복음을 전하는 것을 즐깁니다.' },
                { id: 37, text: '제가 예수님을 믿고 변화된 삶의 이야기를 나눌 때, 믿지 않는 친구들이 마음을 엽니다.' },
                { id: 62, text: '믿지 않는 친구들과 좋은 관계를 유지하면서도, 제 신앙을 자연스럽게 표현하는 편입니다.' },
                { id: 87, text: '주변 사람들이 복음을 전하지 않을 때 안타까운 마음이 들고, 더 열심히 전도해야겠다는 동기부여를 받습니다.' },
                { id: 112, text: '믿지 않는 사람들에게 복음을 전하려는 진심 때문에, 그들에게 좋은 인상을 주는 편입니다.' }
            ]},
            { id: 'hospitality', name: '대접', questions: [
                { id: 13, text: '누구든지 우리 집에 편하게 머물다 갈 수 있도록 집을 개방하는 것을 좋아합니다.' },
                { id: 38, text: '교회나 공동체 행사가 있을 때, 음식을 준비하거나 자리를 정리하는 등 몸으로 섬기는 것을 기뻐합니다.' },
                { id: 63, text: '우리 집에 방문한 사람들은 마치 자기 집처럼 편안하고 아늑하다고 말합니다.' },
                { id: 88, text: '사람들은 제가 다른 사람들을 대접하고 챙겨주는 것을 좋아한다고 이야기합니다.' },
                { id: 113, text: '필요하다면 언제든지 제 공간을 다른 사람들을 위해 기꺼이 내어줄 마음이 있습니다.' }
            ]},
            { id: 'faith', name: '믿음', questions: [
                { id: 14, text: '어떤 모임에서든 자연스럽게 다른 사람들의 의견을 종합하고 방향을 제시하는 역할을 맡게 됩니다.' },
                { id: 39, text: '다른 사람들이 불가능하다고 생각하는 상황에서도, 하나님이 일하실 것을 굳게 믿고 나아갑니다.' },
                { id: 64, text: '사람들은 제가 보통 사람들이 생각하기 힘든 큰 비전을 품고 믿음으로 도전한다고 말합니다.' },
                { id: 89, text: '하나님의 사역이 앞으로 어떻게 펼쳐질지에 대한 특별한 확신과 그림이 보일 때가 있습니다.' },
                { id: 114, text: '종종 하나님이 주시는 담대한 꿈과 비전을 다른 사람들과 나누며, 그들을 격려합니다.' }
            ]},
            { id: 'administration', name: '다스림(리더십)', questions: [
                { id: 16, text: '체계가 잡히지 않은 모임이나 조직의 약점을 파악하고, 더 나은 방향으로 개선하는 것을 즐깁니다.' },
                { id: 41, text: '어떤 목표를 이루기 위해 필요한 아이디어, 사람, 자원 등을 효율적으로 조직하고 계획하는 데 능숙합니다.' },
                { id: 66, text: '공동체의 목표를 명확하게 설정하고, 구성원들이 그 목표를 함께 이루도록 이끄는 것에 자신 있습니다.' },
                { id: 91, text: '사람들에게 억지로 강요하지 않고도, 그들이 자발적으로 따르고 함께하도록 이끌어 갑니다.' },
                { id: 116, text: '교회나 공동체에서 어떤 일을 성공적으로 완수해야 하는 책임을 맡는 것을 즐거워합니다.' }
            ]},
            { id: 'poverty', name: '청빈(자발적 가난)', questions: [
                { id: 21, text: '더 편안하게 살 수 있지만, 하나님 나라와 이웃을 위해 자발적으로 소박하고 검소한 삶을 삽니다.' },
                { id: 46, text: '꼭 필요한 것 외에는 소유하지 않는 단순한 삶의 방식에서 기쁨과 자유함을 느낍니다.' },
                { id: 71, text: '물질적으로 넉넉하지 않은 사람들의 삶에 깊이 공감하며, 그들과 쉽게 어울립니다.' },
                { id: 96, text: '사람들은 제가 주님의 일을 위해 자신의 물질을 너무 많이 희생한다고 걱정할 때가 있습니다.' },
                { id: 121, text: '물질에 얽매이지 않는 제 삶의 태도가 가난한 사람들에게 위로와 동질감을 줍니다.' }
            ]},
            { id: 'intercession', name: '중보기도', questions: [
                { id: 23, text: '다른 어떤 것보다 기도의 시간을 가장 중요하게 생각하며, 매일 꾸준히 지키려고 노력합니다.' },
                { id: 48, text: '누군가에게 기도 부탁을 받으면, 그 기도 제목을 잊지 않고 오랫동안 마음에 품고 기도합니다.' },
                { id: 73, text: '다른 사람이나 공동체를 위해 기도하는 시간이 제게는 가장 의미 있고 즐거운 시간입니다.' },
                { id: 98, text: '제가 기도해 준 사람들은 기도를 통해 큰 힘을 얻고, 놀라운 응답을 경험했다고 말합니다.' },
                { id: 123, text: '기도할 때, 하나님께서 제게 특별한 마음이나 말씀을 주시며 응답하시는 것을 자주 경험합니다.' }
            ]},
            { id: 'service', name: '봉사', questions: [
                { id: 25, text: '교회나 공동체에 필요한 일이 생겼을 때, 누가 시키지 않아도 기쁘게 참여합니다.' },
                { id: 50, text: '특별한 기술은 없지만, 공동체를 위해 궂은일이라도 기꺼이 하는 편입니다.' },
                { id: 75, text: '사람들은 제가 단순하고 반복되는 일이라도 싫증 내지 않고 꾸준히 잘 감당한다고 칭찬합니다.' },
                { id: 100, text: '가만히 앉아 있기보다, 직접 몸을 움직여 무언가 행동으로 섬기는 것을 더 좋아합니다.' },
                { id: 125, text: '아무리 작고 사소해 보이는 일이라도, 공동체를 위한 섬김의 기회가 주어지면 기쁨으로 응답합니다.' }
            ]},
            {id: 'administration', name: '행정', questions: [
                { id: 201, text: '조직의 목표를 명확하게 세우고, 그 목표를 이루기 위한 구체적인 계획을 세우는 것을 즐깁니다.' },
                { id: 202, text: '다양한 자원(사람, 시간, 재정)을 체계적으로 관리하고 가장 효과적인 곳에 배치하는 데 강점이 있습니다.' },
                { id: 203, text: '사람들은 제가 맡은 일이나 프로젝트가 질서정연하게 잘 진행된다고 자주 말합니다.' },
                { id: 204, text: '복잡한 일을 단계별로 나누고 우선순위를 정해서 효율적으로 처리하는 데 자신 있습니다.' },
                { id: 205, text: '제가 속한 모임이나 조직은 시간이 지날수록 점점 더 안정적이고 효율적으로 운영됩니다.' }
            ]}
        ];

        const questionsContainer = document.getElementById('questions-container');
        const form = document.getElementById('gifts-form');
        const resultsDiv = document.getElementById('results');
        const resultsList = document.getElementById('results-list');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');

        let allQuestions = [];

        giftsData.forEach(gift => { 
            gift.questions.forEach(question => {
                allQuestions.push({ 
                    ...question, 
                    giftId: gift.id, 
                    giftName: gift.name 
                });
            });
        });

        allQuestions.sort(() => Math.random() - 0.5);
        
        const totalQuestions = allQuestions.length;
        progressText.textContent = `0 / ${totalQuestions}`;

        allQuestions.forEach((question, index) => {
            const card = document.createElement('div');
            card.className = 'question-card';
            card.innerHTML = `
                <p class="question-text">${index + 1}. ${question.text}</p>
                <div class="score-selector">
                    <button type="button" class="score-btn" data-value="3">3</button>
                    <button type="button" class="score-btn" data-value="2">2</button>
                    <button type="button" class="score-btn" data-value="1">1</button>
                    <button type="button" class="score-btn" data-value="0">0</button>
                </div>
                <input type="hidden" name="q${question.id}" data-gift-id="${question.giftId}" value="">
            `;
            questionsContainer.appendChild(card);
        });

        questionsContainer.addEventListener('click', function(e) {
            if (e.target.classList.contains('score-btn')) {
                const button = e.target;
                const value = button.dataset.value;
                const parentSelector = button.parentElement;
                const questionCard = parentSelector.parentElement;
                const hiddenInput = questionCard.querySelector('input[type="hidden"]');
                
                parentSelector.querySelectorAll('.score-btn').forEach(btn => btn.classList.remove('selected'));
                button.classList.add('selected');
                hiddenInput.value = value;
                
                updateProgress();
            }
        });
        
        function updateProgress() {
            const answeredQuestions = document.querySelectorAll('input[type="hidden"][value]:not([value=""])').length;
            const percentage = (answeredQuestions / totalQuestions) * 100;
            progressBar.style.width = `${percentage}%`;
            progressText.textContent = `${answeredQuestions} / ${totalQuestions}`;
        }

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            const answeredQuestions = document.querySelectorAll('input[type="hidden"][value]:not([value=""])').length;
            if (answeredQuestions < totalQuestions) {
                alert('모든 문항에 답변해주세요.');
                return;
            }

            const scores = {};
            const uniqueGifts = [...new Map(giftsData.map(item => [item.id, item])).values()];

            uniqueGifts.forEach(gift => {
                scores[gift.id] = { 
                    name: gift.name, 
                    score: 0, 
                    questionCount: giftsData.filter(g => g.id === gift.id).reduce((acc, cur) => acc + cur.questions.length, 0)
                };
            });

            document.querySelectorAll('input[type="hidden"]').forEach(input => {
                if (input.value !== '') {
                    const giftId = input.dataset.giftId;
                    scores[giftId].score += parseInt(input.value);
                }
            });
            
            const sortedGifts = Object.entries(scores).map(([id, data]) => {
                return { id, ...data };
            }).sort((a, b) => b.score - a.score);

            displayResults(sortedGifts.slice(0, 5));
        });

        function displayResults(topGifts) {
            resultsList.innerHTML = '';
            const rankPrefix = ['🥇', '🥈', '🥉', '4', '5'];
            
            resultsDiv.querySelector('h2').textContent = `나의 은사 테스트 결과 (상위 ${topGifts.length}개)`;

            topGifts.forEach((gift, index) => {
                if (gift.score === 0) return;

                const maxScore = gift.questionCount * 3;
                const percentage = maxScore > 0 ? (gift.score / maxScore) * 100 : 0;

                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';
                resultItem.innerHTML = `
                    <div class="rank">${rankPrefix[index] || (index + 1)}</div>
                    <div class="result-details">
                        <p class="gift-name">${gift.name}</p>
                        <div class="progress-bar-container">
                            <div class="progress-bar" style="width: 0%;" data-percentage="${percentage}">
                                ${gift.score}점
                            </div>
                        </div>
                    </div>`;
                resultsList.appendChild(resultItem);
            });

            resultsDiv.style.display = 'block';
            
            setTimeout(() => {
                resultsDiv.querySelectorAll('.progress-bar').forEach(bar => {
                    bar.style.width = bar.dataset.percentage + '%';
                });
            }, 100);

            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    </script>
</body>
</html>
